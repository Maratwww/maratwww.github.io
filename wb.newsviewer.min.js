/* jQuery News Viewer Plugin for WYSIWYG Web Builder 17 - Copyright Pablo Software solutions 2022 - http://www.wysiwygwebbuilder.com */
(function(c){function q(c){return 10>c?"0"+c:c}function l(d,a,b,e,g,f){var h=c("<a></a>").attr("href",a).attr("target",f.target).html(b);a=c("<h4></h4>").append(h);"marquee"==f.mode&&(g=g.replace("<br>"," "));if(f.includeDate){e=new Date(e);if("calendar"==f.dateFormat){h.html("");h.addClass("headline");a=c('<div class="headline-calendar"><div class="headline-calendar-date"></div> <div class="headline-calendar-month"></div></div>');var k=c('<div class="headline-content"><div class="headline-title"></div><div class="headline-description"></div></div>');
c(".headline-calendar-date",a).text(e.getDate());c(".headline-calendar-month",a).text(e.toLocaleString(navigator.language,{month:"short"}));c(".headline-title",k).html(b);c(".headline-description",k).html(g);h.append(a);h.append(k);0!=f.animation&&1!=f.animation&&6!=f.animation&&7!=f.animation||"rotate"!=f.mode||h.css({opacity:0});0==f.sortOrder?h.appendTo(d):h.prependTo(d);return}if("twitter"==f.dateFormat)e=parseInt(((new Date).getTime()-e.getTime())/1E3),b=60>e?"less than a minute ago":120>e?"about a minute ago":
3600>e?parseInt(e/60).toString()+" minutes ago":7200>e?"about an hour ago":86400>e?"about "+parseInt(e/3600).toString()+" hours ago":172800>e?"1 day ago":parseInt(e/86400).toString()+" days ago";else{h="January February March April May June July August September October November December".split(" ");k="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");var p=e.getFullYear(),r=p.toString().substring(2),n=e.getMonth()+1,l=e.getDate(),m=e.getHours(),w=e.getMinutes(),t=e.getSeconds();
b=f.dateFormat;b=b.replace("hh",q(m));b=b.replace("h",m);b=b.replace("nn",q(w));b=b.replace("n",w);b=b.replace("ss",q(t));b=b.replace("s",t);b=b.replace("yy",p);b=b.replace("y",r);b=b.replace("mm",q(n));b=b.replace("m",n);b=b.replace("dd",q(l));b=b.replace("d",l);b=b.replace("DD","X1");b=b.replace("D","X2");b=b.replace("MM","X3");b=b.replace("M","X4");b=b.replace("X1",k[e.getDay()]);b=b.replace("X2",k[e.getDay()].substring(0,2));b=b.replace("X3",h[n-1]);b=b.replace("X4",h[n-1].substring(0,3))}e=c("<div></div>").addClass("publication-date").text(b)}else e=
c("<div></div>");g=c("<div></div>").addClass("summary").html(g);a=c('<div role="article"></div>').addClass("headline").append(a,e,g,"");0!=f.animation&&1!=f.animation&&6!=f.animation&&7!=f.animation||"rotate"!=f.mode||a.css({opacity:0});0==f.sortOrder?a.appendTo(d):a.prependTo(d)}function m(d,a){var b="#"+d.attr("id")+" .headline";if("default"==a.mode)d.css("overflow-y","auto"),c(b).css("position","relative"),c(b).css("height","auto"),c(b).css("top","0");else if("rotate"==a.mode){var e=0,g=0,f=0;
if(0==a.animation||1==a.animation||6==a.animation||7==a.animation)c(b).eq(e).css({opacity:1});else if(2==a.animation||3==a.animation)f="100%",3==a.animation&&(f="-100%"),c(b).css("left",f),c(b).eq(e).css("left",0);else if(4==a.animation||5==a.animation)c(b).eq(e).css("top",0),f="100%",5==a.animation&&(f="-100%");var h=c(b).length,k,p=!1,r={},n={},l=function(){p||(p=!0,k=!1,e=(g+1)%h,0==a.animation||1==a.animation?(r={opacity:0},n={opacity:1}):2==a.animation||3==a.animation?(r={left:"100%"==f?"-100%":
"100%"},n={left:0}):4==a.animation||5==a.animation?(r={top:"100%"==f?"-100%":"100%"},n={top:0}):6==a.animation?(r={opacity:0,scale:5},n={opacity:1,scale:1},c(b).eq(g).animate({scale:0},0)):7==a.animation&&(r={opacity:0,rotate:0,scale:0},n={opacity:1,rotate:1440,scale:1},c(b).eq(g).animate({rotate:0},0)),c(b).eq(g).animate(r,a.animationDuration,function(){2==a.animation||3==a.animation?c(this).css("left",f):4==a.animation||5==a.animation?c(this).css("top",f):6==a.animation&&c(this).animate({scale:0},
0)}),c(b).eq(e).animate(n,a.animationDuration,function(){p=!1;k||(k=setTimeout(l,a.pause))}),g=e)};k||(k=setTimeout(l,a.pause));d.hover(function(){clearTimeout(k);k=!1},function(){k||(k=setTimeout(l,250))})}else if("scroller"==a.mode)c(b).css("position","relative"),c(b).css("height","auto"),c(b).css("top","0"),a.line_count=d.height(),a.rotate=!0,d.hover(function(){a.rotate=!1},function(){a.rotate=!0}),x(d,a);else if("paginate"==a.mode){d.css("overflow-y","auto");c(b).css("position","relative");c(b).css("height",
"auto");c(b).css("top","0");var m=0,q=function(){d.find(".headline").hide().slice(m*a.numPerPage,(m+1)*a.numPerPage).show()},t=d.find(".headline").length;t=Math.ceil(t/a.numPerPage);for(var y=c('<div class="pager"></div>'),u=0;u<t;u++)c('<span class="page-number"></span>').text(u+1).bind("click",{newPage:u},function(a){m=a.data.newPage;q();c(this).addClass("active").siblings().removeClass("active")}).appendTo(y).addClass("clickable");y.prependTo(d).find("span.page-number:first").addClass("active");
q()}else"ticker"==a.mode?(c(b).css("position","relative"),c(b).css("height","auto"),c(b).css("top","0"),setTimeout(function(){z(d,a)},a.pause)):"marquee"==a.mode&&(c(b).css("position","relative"),c(b).css("height","auto"),c(b).css("top","0"),a.pause=!1,a.frameId=null,a.starttime=(new Date).getTime(),c(".headline",d).clone().appendTo(d),v(d,a),d.hover(function(){a.pause=!0;a.starttime=(new Date).getTime()-a.starttime;cancelAnimationFrame(a.frameId);a.frameId=null},function(){a.starttime=(new Date).getTime()-
a.starttime;a.pause=!1;v(d,a)}))}function x(d,a){var b=a.container.height();a.line_count+=a.rotate?-2:0;c("p",d).css("top",a.line_count);a.line_count<-b-20&&(a.line_count=d.height());setTimeout(function(){x(d,a)},a.speed)}function z(d,a){d.find(".headline:first").clone().appendTo(d).css("display","none");var b=d.find(".headline:first").outerHeight();c(".headline",d).animate({top:-b},a.animationDuration);c(":animated").promise().done(function(){d.find(".headline:first").remove();c(".headline",d).css({top:0});
d.find(".headline:last").fadeIn();setTimeout(function(){z(d,a)},a.pause)})}function v(d,a){var b=1==a.animation?"margin-right":"margin-left",e=d.find(".headline:first"),g=e.outerWidth(),f=d.outerWidth()/2;f=((new Date).getTime()-a.starttime)/a.animationDuration/(g/f);f=Math.min(f,1);marginLeft=-(g*f).toFixed(2);e.css(b,marginLeft);marginLeft<=-g&&(e.clone().appendTo(d).css("display","none").fadeIn(),e.remove(),c(".headline",d).css(b,"0px"),a.starttime=(new Date).getTime());a.pause||(a.frameId=requestAnimationFrame(function(){v(d,
a)}))}c.fn.newsviewer=function(d){var a=c.extend({animation:0,animationDuration:500,dataSource:"local",dateFormat:"yy/mm/dd",access_token:"",facebook_post_types:["status","photo","link"],includeDate:!0,maxItems:10,mode:"default",numPerPage:1,param:null,pause:5E3,sortOrder:0,speed:50,target:"_self",url:null},d);return this.each(function(){c.newsviewer(c(this),a)})};c.newsviewer=function(d,a){d.empty();"scroller"==a.mode&&c("<p></p>").css("position","relative").appendTo(d);a.container=d;"scroller"==
a.mode&&(a.container=c("p",d));if("local"==a.dataSource){if(null!=a.param)for(var b=0;b<a.param.length;b++)l(a.container,a.param[b][0],a.param[b][1],a.param[b][2],a.param[b][3],a);m(d,a)}else if("csv"==a.dataSource){var e=c("<img/>").attr({src:"wb.newsviewer.gif",alt:"Loading. Please wait."}).addClass("news-wait").appendTo(d);c.get(a.url,function(b){e.remove();for(var c=[""],h=[c],k=!1,p=0;p<b.length;p++){var g=b[p],n=b[p+1];if(k)'"'===g&&'"'===n?(c[c.length-1]+=g,p++):'"'===g?k=!1:c[c.length-1]+=
g;else{var q=0===c[c.length-1].length;'"'===g&&q?k=!0:","===g?c.push(""):"\r"===g&&"\n"===n?(c=[""],h.push(c),p++):"\n"===g||"\r"===g?(c=[""],h.push(c)):c[c.length-1]+=g}}b=Math.min(h.length,a.maxItems);for(c=0;c<b;c++)l(a.container,h[c][0],h[c][1],h[c][2],h[c][3],a);m(d,a)})}else"json"==a.dataSource?(e=c("<img/>").attr({src:"wb.newsviewer.gif",alt:"Loading. Please wait."}).addClass("news-wait").appendTo(d),c.getJSON(a.url,function(b){e.remove();c.each(b,function(c,b){l(a.container,b.link,b.title,
b.date,b.description,a)});m(d,a)})):"rss"==a.dataSource?(e=c("<img/>").attr({src:"wb.newsviewer.gif",alt:"Loading. Please wait."}).addClass("news-wait").appendTo(d),c.get(a.url,function(b){e.remove();1==c("feed",b).length?c("feed entry",b).each(function(b,d){if(b>=a.maxItems)return!1;l(a.container,c("link",this).text(),c("title",this).text(),c("updated",this).text(),c("content",this).text(),a)}):c("rss item",b).each(function(b,d){if(b>=a.maxItems)return!1;l(a.container,c("link",this).text(),c("title",
this).text(),c("pubDate",this).text(),c("description",this).text(),a)});m(d,a)})):"twitter"==a.dataSource?(e=c("<img/>").attr({src:"wb.newsviewer.gif",alt:"Loading. Please wait."}).addClass("news-wait").appendTo(d),c.getJSON(a.url,function(b){e.remove();c.each(b,function(c,b){var d=b.created_at.split(" ");d=Date.parse(d[1]+" "+d[2]+", "+d[5]+" "+d[3]);var e=b.text.replace(/((http|https):\/\/\S+)/g,'<a target="_blank" href="$1">$1</a>');e=e.replace(/@(\w+)/g,'<a target="_blank" href="http://twitter.com/$1">@$1</a>');
l(a.container,"http://twitter.com/"+a.param,e,d,"",a)});m(d,a)})):"twittersearch"==a.dataSource?(e=c("<img/>").attr({src:"wb.newsviewer.gif",alt:"Loading. Please wait."}).addClass("news-wait").appendTo(d),c.getJSON(a.url,function(b){e.remove();c.each(b.statuses,function(c,b){var d=b.created_at.split(" ");d=Date.parse(d[1]+" "+d[2]+", "+d[5]+" "+d[3]);var e=b.text.replace(/(http:\/\/\S+)/g,'<a target="_blank" href="$1">$1</a>');e=e.replace(/@(\w+)/g,'<a target="_blank" href="http://twitter.com/$1">@$1</a>');
l(a.container,"http://www.twitter.com/"+b.user.screen_name,'<img style="border-width:0;padding:0px 10px 10px 0px;float:left;" src="'+b.user.profile_image_url+'">'+e,d,"",a)});m(d,a)})):"facebook"==a.dataSource?(e=c("<img/>").attr({src:"wb.newsviewer.gif",alt:"Loading. Please wait."}).addClass("news-wait").appendTo(d),b="https://graph.facebook.com/"+a.param,b=b+"/feed?access_token="+a.access_token,b=b+"&limit="+a.maxItems,c.getJSON(b+"&fields=type,picture,message,link,story,created_time,from&callback=?",
function(b){e.remove();c.each(b.data,function(b,d){if(0<=c.inArray(d.type,a.facebook_post_types)){var e=new Date((d.created_time||"").replace(/-/g,"/").replace(/TZ/g," "));(new Date).getTime();e.getTime();var f="",g=a.param;null!=d.from&&(g=d.from.name);void 0!=d.message?f=d.message:void 0!=d.story&&(f=d.story);"link"==d.type&&-1==f.indexOf(d.link)&&(""!=f&&(f+="<br>"),f+=d.link);f=f.replace(/\b((http|https):\/\/\S+)/g,'<a target="_blank" href="$1">$1</a>');"photo"==d.type&&(f+='<div class="picture">',
void 0!=d.link&&(f=f+'<a href="'+d.link,f+='" target="_blank">'),f=f+'<img src="'+d.picture,f+='">',void 0!=d.link&&(f+="</a>"),f+="</div>");l(a.container,"http://www.facebook.com/profile.php?id="+a.param,g,e,f,a)}});m(d,a)})):"flickr"==a.dataSource?(e=c("<img/>").attr({src:"wb.newsviewer.gif",alt:"Loading. Please wait."}).addClass("news-wait").appendTo(d),b="http://api.flickr.com/services/feeds/photos_public.gne?format=json&",null!=a.param&&(b+=a.param,b+="&"),c.getJSON(b+"jsoncallback=?",function(b){e.remove();
c.each(b.items,function(b,d){var e=c("<a></a>").attr("href",d.link).attr("target",a.target).text(d.title);e=c("<h4></h4>").append(e);var f=c("<div></div>").addClass("publication-date").text(d.author.split("(")[1].replace(")","")),g=c("<img>").attr("src",d.media.m);c("<div></div>").addClass("headline").append(e,f,g,"").appendTo(a.container);if(b==a.maxItems)return!1});m(d,a)})):"instagram"==a.dataSource&&(e=c("<img/>").attr({src:"wb.newsviewer.gif",alt:"Loading. Please wait."}).addClass("news-wait").appendTo(d),
b="https://api.instagram.com/v1/users/"+a.param,b=b+"/media/recent/?access_token="+a.access_token,b=b+"&count="+a.maxItems,c.ajax({url:b,crossDomain:!0,dataType:"jsonp"}).done(function(b){e.remove();c.each(b.data,function(c,d){var e=null==b.data[c].caption||void 0==b.data[c].caption?"":b.data[c].caption.text,f=Date(b.data[c].created_time),g=b.data[c].images.standard_resolution.url.replace(/\\/,"");l(a.container,g,'<img style="border-width:0;width:100%;height:auto;float:left;" src="'+g+'">'+e,f,"",
a)});m(d,a)}))}})(jQuery);